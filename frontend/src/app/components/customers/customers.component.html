<div class="row">
  <div class="col-md-12">
    <h2>ğŸ‘¥ Gestion des Clients</h2>
  </div>
</div>

<!-- Barre de recherche et bouton d'ajout -->
<div class="row mt-3">
  <div class="col-md-8">
    <div class="input-group">
      <input
        type="text"
        class="form-control"
        placeholder="Rechercher un client..."
        [(ngModel)]="searchKeyword"
        (keyup.enter)="searchCustomers()">
      <button class="btn btn-outline-secondary" type="button" (click)="searchCustomers()">
        ğŸ” Rechercher
      </button>
    </div>
  </div>
  <div class="col-md-4">
    <button class="btn btn-primary" (click)="showAddForm = !showAddForm">
      â• Nouveau Client
    </button>
  </div>
</div>

<!-- Formulaire d'ajout/modification -->
<div class="row mt-3" *ngIf="showAddForm">
  <div class="col-md-12">
    <div class="card">
      <div class="card-header">
        <h5>{{ editingCustomer ? 'Modifier' : 'Ajouter' }} un Client</h5>
      </div>
      <div class="card-body">
        <form (ngSubmit)="saveCustomer()" #customerForm="ngForm">
          <div class="row">
            <div class="col-md-6">
              <div class="mb-3">
                <label for="name" class="form-label">Nom complet *</label>
                <input
                  type="text"
                  class="form-control"
                  id="name"
                  [(ngModel)]="currentCustomer.name"
                  name="name"
                  required>
              </div>
            </div>
            <div class="col-md-6">
              <div class="mb-3">
                <label for="email" class="form-label">Email *</label>
                <input
                  type="email"
                  class="form-control"
                  id="email"
                  [(ngModel)]="currentCustomer.email"
                  name="email"
                  required>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-md-12">
              <button type="submit" class="btn btn-success me-2" [disabled]="!customerForm.form.valid">
                ğŸ’¾ {{ editingCustomer ? 'Modifier' : 'Ajouter' }}
              </button>
              <button type="button" class="btn btn-secondary" (click)="cancelForm()">
                âŒ Annuler
              </button>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<!-- Liste des clients -->
<div class="row mt-4">
  <div class="col-md-12">
    <div class="card">
      <div class="card-header">
        <h5>Liste des Clients ({{ customers.length }})</h5>
      </div>
      <div class="card-body">
        <div *ngIf="loading" class="text-center">
          <div class="spinner-border" role="status">
            <span class="visually-hidden">Chargement...</span>
          </div>
        </div>

        <div *ngIf="!loading && customers.length === 0" class="text-center text-muted">
          Aucun client trouvÃ©
        </div>

        <div *ngIf="!loading && customers.length > 0" class="table-responsive">
          <table class="table table-striped table-hover">
            <thead class="table-dark">
              <tr>
                <th>ID</th>
                <th>Nom</th>
                <th>Email</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let customer of customers">
                <td>{{ customer.id }}</td>
                <td>{{ customer.name }}</td>
                <td>{{ customer.email }}</td>
                <td>
                  <button class="btn btn-sm btn-outline-primary me-2" (click)="editCustomer(customer)">
                    âœï¸ Modifier
                  </button>
                  <button class="btn btn-sm btn-outline-danger me-2" (click)="deleteCustomer(customer)">
                    ğŸ—‘ï¸ Supprimer
                  </button>
                  <button class="btn btn-sm btn-outline-info" (click)="viewCustomerAccounts(customer)">
                    ğŸ’³ Comptes
                  </button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>
